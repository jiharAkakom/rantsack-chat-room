<!DOCTYPE html>
<html>
  <head>
    <title>Rantsack Chat Room</title>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
    <script type='text/javascript'>
      function updatePage(){
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            var text = String(JSON.parse(this.responseText));
            var textArea = document.getElementById("messages");
            textArea.value = text;
            textArea.scrollTop = textArea.scrollHeight;
          }
        };
        xhttp.open("GET", "/get_messages", true);
        xhttp.send();
      }
      setInterval(updatePage, 1000);
    </script>
    <script type='text/javascript'>
      $(function () {
        $('form').on('submit', function (e) {
          e.preventDefault();
          $.ajax({
            type: 'post',
            url: '/',
            data: $('form').serialize(),
            success: function () {
              document.getElementById('message').value = ''
            }
          });
        });
      });
    </script>
  </head>
  <body>
    <h1>Rantsack Chat Room</h1>
    <p>Messages:</p>
    <textarea id="messages" readonly style="width:100%;" rows=10 placeholder="There are no messages to display.">
    </textarea>
    <hr>
    <form>
      Message: <input id="message" type="text" name="message" style="width:100%;" placeholder="Enter message here."><br>
      <input name="submit" type="submit" value="Send">
    </form> 
  </body>
</html>

